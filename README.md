# SingleStone Exercise

## Exercise 1
Exercise 1 required deploying a lambda function and an application load balancer in front of the lambda function using an IaC tool. I chose Terraform because I found it to be more straightforward and much easier to learn than CloudFormation.

The actual Python code for the API contained the requests library which is not available by default on Lambda, so I had to manually add the packages in the local directory using `pip install requests -t .`. In Terraform, I added an `archive_file` block which will automatically zip up the contents of the python directory so new code will get deployed in the future (assuming there are changes).

The Terraform is pretty straight forward too - the Terraform code for the Lambda portion is mostly identical to what you find [here in the Terraform docs for Lambda Function.](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function) Creates and IAM role and a new Lambda function.

The application load balancer for it is mostly stock info you'd find from the Terraform docs too. The trickiest thing to actually find was the target group attachment for the lambda function, but once I found that it wasn't too complicated. The security group is setup to expose it to the entire internet, as well as letting it access the entire internet. Chose port 80 for the LB and made it HTTP because I didn't want to get involved with making a cert and everything that goes into that just to give this demo HTTPS.

## Exercise 2
Exercise 2 involved deploying an autoscaling website on some EC2 servers that should automatically bootstrap themselves once again with an IaC tool. Still using Terraform

Website is straightforward - just changed the URL in the fetch call to be the endpoint generated by the load balancer from exercise 1. One unfortunate thing about it is because of the default Nginx settings the machines use to bootstrap themselves they cannot actually hit the API endpoint, but they do try.

Terraform is functioning but doesn't actually scale depending on load - I couldn't figure out what object that was in Terraform or how to write it. But if you manually delete the EC2 instances that power everything it will scale them back up :)

A security group exist for SSH and HTTP access to the individual severs, while a different security group exists for just the LB. The launch configuration involves curling `index.html` from this repo and placing it inside of an nginx folder to deploy it. I was struggling to figure out how to connect a new EC2 LB to the autoscaling group, so I used a classic ELB instead because it was straightforward. Load balancer is HTTP again because I didn't want to get involved with SSL stuff for this small exercise.